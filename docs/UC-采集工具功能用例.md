# 采集工具库功能用例

## 概述

采集工具是数据收集的载体，支持表单、问卷、访谈、现场查验四种类型，用于定义数据采集的字段和逻辑。

## 页面功能

| 功能 | 说明 |
|------|------|
| 工具列表 | 展示所有采集工具，支持搜索过滤 |
| 新建工具 | 创建新的采集工具（类型、名称、填报对象、描述） |
| 查看信息 | 查看工具基础信息和状态 |
| 编辑工具 | 根据类型进入对应编辑器（表单设计器/访谈提纲设计器/检查清单设计器） |
| 发布 | 发布后可在项目中使用 |
| 取消发布 | 恢复可编辑状态 |
| 删除 | 删除未发布的工具 |

## 工具类型

| 类型 | 编辑器 | 说明 |
|------|--------|------|
| 表单 | 表单设计器 | 可视化拖拽设计，配置字段属性 |
| 问卷 | 第三方问卷系统 | 跳转第三方系统创建和编辑 |
| 访谈 | 访谈提纲设计器 | 按维度组织访谈问题 |
| 现场查验 | 检查清单设计器 | 按类别组织检查项 |

## 与其他模块关系

- 采集工具 ←→ 要素库：要素通过 tool_id + field_id 主动关联表单字段
- 采集工具 ←→ 项目配置：项目分配采集工具给评估对象
- 采集工具 ←→ 数据填报：采集员使用工具填报数据

---

## 功能用例

---

**UC-TOOL-00: 查看采集工具列表**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-00 |
| 用例名称 | 查看采集工具列表 |
| 用例简述 | 系统管理员进入采集工具库页面，查看工具列表，支持按状态、类型筛选和关键字搜索 |
| 参与者 | 系统管理员 |
| 前置条件 | 用户已登录且具有 canManageSystem 权限 |
| 后置条件 | 无状态变更 |

*页面入口：*
- 左侧菜单：系统配置 → 采集工具库

*主流程：*
1. 进入采集工具库页面
2. 列表显示所有采集工具，按更新时间倒序排列
3. 可通过状态下拉筛选（全部/草稿/编辑中/已发布）
4. 可通过类型下拉筛选（全部/表单/问卷/访谈/现场查验）
5. 可通过搜索框按名称模糊搜索
6. 根据工具状态和类型显示不同的操作按钮

*操作入口：*
| 操作 | 入口 | 跳转/弹窗 |
|------|------|----------|
| 创建工具 | 点击"+ 创建采集工具"按钮 | 弹出创建表单 |
| 工具信息 | 点击"工具信息"按钮 | 弹出详情弹窗 |
| 编辑工具 | 点击"编辑工具"按钮 | 跳转到对应类型的编辑器 |
| 发布 | 点击"发布"按钮 | 直接发布 |
| 取消发布 | 点击"取消发布"按钮 | 确认对话框 |
| 删除 | 点击"删除"按钮 | 确认对话框 |

---

**UC-TOOL-01: 创建采集工具**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-01 |
| 用例名称 | 创建采集工具 |
| 用例简述 | 创建新的采集工具，设置工具类型（表单/问卷/访谈/现场查验）、名称、填报对象等基础信息，创建后跳转到对应类型的编辑器 |
| 参与者 | 系统管理员 |
| 前置条件 | 用户已登录且具有 canManageSystem 权限 |
| 后置条件 | 工具创建成功，状态为"草稿"，跳转到对应类型的编辑器 |

*输入字段：*
| 字段 | 类型 | 必填 | 限制 | 说明 |
|------|------|:----:|------|------|
| 工具类型 | enum | ✓ | 表单 \| 问卷 \| 访谈 \| 现场查验 | 决定编辑方式和数据采集方式 |
| 工具名称 | string | ✓ | 1-100字符 | 工具显示名称 |
| 填报对象 | enum[] | ✓ | 多选：区县/学校/教师/学生/班级/家长 | 工具适用的填报对象 |
| 工具描述 | string | | 0-500字符 | 工具用途说明 |

*创建表单界面：*
```
┌─ 创建采集工具 ────────────────────────────────────────┐
│                                                       │
│ * 工具类型                                            │
│   ○ 表单    ○ 问卷    ○ 访谈    ○ 现场查验          │
│                                                       │
│ * 工具名称                                            │
│   [________________________________]                  │
│                                                       │
│ * 填报对象                                            │
│   [区县、学校、教师、学生、班级、家长 ▼] (多选)       │
│                                                       │
│   工具描述                                            │
│   [________________________________]                  │
│   [________________________________]                  │
│                                                       │
│                        [取消]    [创建]               │
└───────────────────────────────────────────────────────┘
```

*主流程：*
1. 点击"+ 创建采集工具"按钮，弹出创建表单
2. 选择工具类型（表单/问卷/访谈/现场查验）
3. 填写工具名称（必填）
4. 选择填报对象（必填，可多选）
5. 填写工具描述（可选）
6. 点击"创建"按钮
7. 创建成功后：
   - **表单类型**：跳转到表单编辑器页面
   - **问卷类型**：跳转到第三方问卷系统创建问卷
   - **访谈类型**：跳转到访谈提纲设计器
   - **现场查验类型**：跳转到检查清单设计器

*问卷类型集成字段（第三方问卷系统）：*
| 字段 | 类型 | 说明 |
|------|------|------|
| external_survey_id | string | 第三方问卷系统的问卷ID |
| external_survey_url | string | 问卷访问链接URL |
| max_score | number | 问卷满分值（由第三方系统返回） |

> 问卷类型工具通过集成第三方问卷系统实现，创建时自动跳转到第三方系统设计问卷，完成后回调保存问卷ID、访问链接和满分值。
>
> **满意度统计**：通过在要素库中创建"满意度"类型要素，关联问卷工具并配置满意阈值，详见要素库功能用例。

*异常流程：*
| 异常 | 处理方式 |
|------|----------|
| 名称为空 | 提示"请输入工具名称" |
| 未选择填报对象 | 提示"请选择填报对象" |
| 名称重复 | 提示"该名称已存在" |

---

**UC-TOOL-02: 编辑表单工具（表单设计器）**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-02 |
| 用例名称 | 编辑表单工具 |
| 用例简述 | 使用可视化表单设计器编辑表单类型工具，通过拖拽控件、配置属性、设置映射来设计数据采集表单 |
| 参与者 | 系统管理员 |
| 前置条件 | 工具类型为"表单"，状态为"草稿"或"编辑中" |
| 后置条件 | 表单结构保存成功 |

*页面布局（三栏式）：*
```
┌─────────────────────────────────────────────────────────────────────────────┐
│ ← 返回   学校基本信息采集表                    [预览] [JSON] [保存]         │
├──────────────┬─────────────────────────────────┬────────────────────────────┤
│  控件库       │         表单画布                 │      属性配置             │
├──────────────┤                                  ├────────────────────────────┤
│ 基础控件      │  ┌───────────────────────────┐  │  字段ID                    │
│  单行文本     │  │ 学校名称 *                │  │  field_1703123456_abc123   │
│  多行文本     │  │ [________________]        │  │  (只读，用于要素关联)       │
│  数字        │  └───────────────────────────┘  │                            │
│  下拉选择     │  ┌───────────────────────────┐  │  字段属性                  │
│  多选框      │  │ 办学类型 *                │  │  标签: [学校名称    ]      │
│  单选框      │  │ ○ 公办  ○ 民办            │  │  占位符: [请输入学校名称]  │
│              │  └───────────────────────────┘  │  帮助文本: [          ]    │
│ 高级控件      │  ┌───────────────────────────┐  │  宽度: [100% ▼]            │
│  日期        │  │ 建校时间                  │  │  [✓] 必填                  │
│  时间        │  │ [____年__月__日]          │  │                            │
│  文件上传     │  └───────────────────────────┘  │  数值设置                  │
│  开关        │  ┌───────────────────────────┐  │  小数位数: [整数 ▼]        │
│  分割线      │  │ 在校学生数                │  │  最小值: [     ]           │
│  分组容器     │  │ [________] 人             │  │  最大值: [     ]           │
│  动态列表     │  └───────────────────────────┘  │  单位: [     ]             │
│              │                                  │                            │
│              │  [+ 拖拽控件到此处添加字段]      │                            │
└──────────────┴─────────────────────────────────┴────────────────────────────┘
```

*控件类型（13种）：*
| 分类 | 控件 | 类型标识 | 说明 |
|------|------|----------|------|
| 基础控件 | 单行文本 | text | 输入单行文字 |
| | 多行文本 | textarea | 输入多行文字 |
| | 数字 | number | 数字输入（小数、范围、单位） |
| | 下拉选择 | select | 单选下拉框 |
| | 多选框 | checkbox | 多选选项 |
| | 单选框 | radio | 单选选项 |
| 高级控件 | 日期 | date | 日期选择器 |
| | 时间 | time | 时间选择器 |
| | 文件上传 | file/upload | 上传文件附件 |
| | 开关 | switch | 是/否切换 |
| | 分割线 | divider | 视觉分隔 |
| | 分组容器 | group | 字段分组 |
| | 动态列表 | dynamicList | 可重复添加的字段组 |

---

**各控件属性配置详解：**

**1. 单行文本 (text)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 占位符 | string | | 输入框提示文字 |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填 |
| 高级设置 | 最大长度 | number | | 最大输入字符数 |
| | 正则校验 | string | | 自定义正则表达式 |
| | 校验提示 | string | | 校验失败提示语 |
| | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**2. 多行文本 (textarea)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 占位符 | string | | 输入框提示文字 |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填 |
| 高级设置 | 最大长度 | number | | 最大输入字符数 |
| | 行数 | number | | 显示行数（默认3行） |
| | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**3. 数字 (number)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 占位符 | string | | 输入框提示文字 |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填 |
| 数值设置 | 小数位数 | enum | | 整数 / 1位 / 2位 / 3位 / 4位 |
| | 最小值 | number | | 数值下限 |
| | 最大值 | number | | 数值上限 |
| | 单位 | string | | 如：个、人、元、% |
| 高级设置 | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**4. 下拉选择 (select)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 占位符 | string | | 如"请选择" |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填 |
| 选项配置 | 选项列表 | array | ✓ | [{label, value}] 格式 |
| | 支持搜索 | boolean | | 选项多时启用搜索 |
| 高级设置 | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**5. 多选框 (checkbox)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填（至少选一项） |
| 选项配置 | 选项列表 | array | ✓ | [{label, value}] 格式 |
| | 选项布局 | enum | | vertical（垂直）/ horizontal（水平） |
| | 最少选择 | number | | 最少选择项数 |
| | 最多选择 | number | | 最多选择项数 |
| 高级设置 | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**6. 单选框 (radio)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填 |
| 选项配置 | 选项列表 | array | ✓ | [{label, value}] 格式 |
| | 选项布局 | enum | | vertical（垂直）/ horizontal（水平） |
| | 默认值 | string | | 默认选中项的value |
| 高级设置 | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**7. 日期 (date)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 占位符 | string | | 如"请选择日期" |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填 |
| 高级设置 | 日期格式 | enum | | YYYY-MM-DD / YYYY/MM/DD / YYYY年MM月DD日 |
| | 最早日期 | string | | 可选择的最早日期 |
| | 最晚日期 | string | | 可选择的最晚日期 |
| | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**8. 时间 (time)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 占位符 | string | | 如"请选择时间" |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填 |
| 高级设置 | 时间格式 | enum | | HH:mm / HH:mm:ss |
| | 分钟步长 | number | | 如 15 表示每15分钟一档 |
| | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**9. 文件上传 (file/upload)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| | 必填 | boolean | | 是否必填 |
| 上传设置 | 文件类型 | array | | 允许的文件扩展名，如 [".pdf", ".doc", ".jpg"] |
| | 最大文件数 | number | | 最多上传文件数（默认1） |
| | 单文件大小限制 | number | | 单个文件最大MB数 |
| | 上传提示 | string | | 如"支持PDF、Word格式，单文件不超过10MB" |
| 高级设置 | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**10. 开关 (switch)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 25% / 33% / 50% / 75% / 100% |
| 开关设置 | 开启文字 | string | | 开启状态显示文字，如"是" |
| | 关闭文字 | string | | 关闭状态显示文字，如"否" |
| | 默认值 | boolean | | 默认开关状态 |
| 高级设置 | 条件显示 | object | | showWhen 规则 |
| | 动态标签 | array | | labelWhen 规则 |

**11. 分割线 (divider)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标题 | string | | 分割线标题文字（可选） |
| 样式设置 | 线条样式 | enum | | solid（实线）/ dashed（虚线） |
| | 标题位置 | enum | | left / center / right |
| 高级设置 | 条件显示 | object | | showWhen 规则 |

**12. 分组容器 (group)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 分组标题 | string | ✓ | 分组显示名称 |
| | 分组说明 | string | | 分组描述文字 |
| 样式设置 | 边框样式 | enum | | bordered（有边框）/ plain（无边框） |
| | 默认展开 | boolean | | 是否默认展开 |
| | 可折叠 | boolean | | 是否可折叠 |
| 高级设置 | 条件显示 | object | | showWhen 规则 |

> 分组容器内可拖入其他字段，形成字段分组。

**13. 动态列表 (dynamicList)**
| 属性分类 | 属性 | 类型 | 必填 | 说明 |
|----------|------|------|:----:|------|
| 基础属性 | 字段ID | string | - | 系统自动生成，只读 |
| | 标签 | string | ✓ | 字段显示名称 |
| | 帮助文本 | string | | 字段说明 |
| | 宽度 | enum | | 固定100% |
| | 必填 | boolean | | 是否必须添加至少一条 |
| 列表设置 | 最少条目 | number | | 最少添加条数 |
| | 最多条目 | number | | 最多添加条数 |
| | 显示模式 | enum | | table（表格）/ card（卡片） |
| | 表头配置 | array | | 表格模式的列标题 |
| 子字段配置 | 子字段列表 | array | ✓ | 每条记录包含的字段定义 |

*动态列表子字段支持的类型：*
| 子字段类型 | 说明 |
|------------|------|
| text | 单行文本 |
| textarea | 多行文本 |
| number | 数字 |
| select | 下拉选择 |
| date | 日期 |
| time | 时间 |

*动态列表配置示例：*
```json
{
  "type": "dynamicList",
  "label": "主要荣誉",
  "minItems": 0,
  "maxItems": 10,
  "displayMode": "table",
  "headers": ["荣誉名称", "获得时间", "授予单位", "级别"],
  "fields": [
    { "type": "text", "label": "荣誉名称", "required": true },
    { "type": "date", "label": "获得时间", "required": true },
    { "type": "text", "label": "授予单位" },
    { "type": "select", "label": "级别", "options": [
      { "label": "国家级", "value": "national" },
      { "label": "省级", "value": "province" },
      { "label": "市级", "value": "city" },
      { "label": "区县级", "value": "district" }
    ]}
  ]
}
```

---

*字段ID说明：*
| 属性 | 说明 |
|------|------|
| 字段ID (id) | 系统自动生成，格式：`field_时间戳_随机串`，如 `field_1703123456_abc123` |
| 显示位置 | 属性面板顶部显示（只读），用于要素关联时选择 |
| 用途 | 要素通过 tool_id + field_id 关联表单字段，从填报数据中获取值 |

*字段属性配置：*
| 属性分类 | 属性 | 适用控件 | 说明 |
|----------|------|----------|------|
| 基础属性 | 字段ID (id) | 全部 | 系统自动生成，只读显示，用于要素关联 |
| | 标签 (label) | 全部 | 字段显示名称（必填） |
| | 占位符 (placeholder) | 文本/数字/日期/时间 | 输入提示 |
| | 帮助文本 (helpText) | 全部 | 字段说明 |
| | 宽度 (width) | 全部 | 25% / 33% / 50% / 75% / 100% |
| | 必填 (required) | 全部 | 是否必填 |
| 数值设置 | 小数位数 (decimalPlaces) | number | 整数 / 1位 / 2位 |
| | 最小值 (minValue) | number | 数值下限 |
| | 最大值 (maxValue) | number | 数值上限 |
| | 单位 (unit) | number | 如：个、人、元 |
| 选项设置 | 选项 (options) | select/checkbox/radio | 选项列表 |
| | 选项布局 (optionLayout) | checkbox/radio | vertical / horizontal |
| 条件控制 | 条件显示 (showWhen) | 全部 | 根据其他字段值控制显示/隐藏 |
| | 动态标签 (labelWhen) | 全部 | 根据条件动态切换字段标签 |

> **关于字段与要素的关联**：
> - 由要素库中的要素主动关联表单字段（通过 tool_id + field_id）
> - 在要素编辑时，先选择采集工具，再从该工具的字段列表中选择具体字段
> - 字段列表显示"字段标签 (字段ID)"格式，方便用户识别和选择
> - 详见要素库功能用例

*条件显示规则 (showWhen)：*
| 属性 | 类型 | 说明 |
|------|------|------|
| fieldId | string | 依赖的字段ID |
| operator | enum | 比较运算符：equals / notEquals / contains / greaterThan / lessThan |
| value | any | 比较值 |

示例：当"办学类型"选择"民办"时显示"举办者"字段
```json
{
  "showWhen": {
    "fieldId": "school_type",
    "operator": "equals",
    "value": "民办"
  }
}
```

*动态标签规则 (labelWhen)：*
| 属性 | 类型 | 说明 |
|------|------|------|
| condition | object | 条件配置（同showWhen） |
| label | string | 满足条件时显示的标签 |

示例：根据学校类型动态切换标签
```json
{
  "labelWhen": [
    { "condition": { "fieldId": "school_type", "operator": "equals", "value": "幼儿园" }, "label": "保教人员数" },
    { "condition": { "fieldId": "school_type", "operator": "equals", "value": "小学" }, "label": "专任教师数" }
  ]
}
```

*动态列表字段配置：*
| 属性 | 说明 |
|------|------|
| 最少条目 (minItems) | 最少添加条数 |
| 最多条目 (maxItems) | 最多添加条数 |
| 表头 (headers) | 列表表头配置，用于表格形式展示 |
| 子字段 (dynamicListFields) | 每条记录包含的字段，支持：text/textarea/number/select/date/time |

*主流程：*
1. 从列表点击"编辑工具"进入表单设计器
2. 从左侧控件库拖拽控件到中间画布
3. 选中控件，在右侧面板配置属性
4. 拖拽调整字段顺序
5. 点击"预览"查看表单效果
6. 点击"保存"保存表单结构

*操作按钮：*
| 按钮 | 功能 |
|------|------|
| 返回 | 返回工具列表 |
| 预览 | 预览表单填报效果 |
| JSON | 导入/导出JSON格式表单结构 |
| 保存 | 保存当前表单 |

*字段操作：*
| 操作 | 说明 |
|------|------|
| 复制 | 快速复制已有字段 |
| 删除 | 删除字段 |
| 拖拽排序 | 拖动调整字段顺序 |

---

**UC-TOOL-03: 编辑访谈工具（访谈提纲设计器）**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-03 |
| 用例名称 | 编辑访谈工具 |
| 用例简述 | 使用访谈提纲设计器编辑访谈类型工具，按维度组织访谈问题，配置关键要点和追问提示，支持与佐证材料关联 |
| 参与者 | 系统管理员 |
| 前置条件 | 工具类型为"访谈"，状态为"草稿"或"编辑中" |
| 后置条件 | 访谈提纲保存成功 |

*访谈对象类型：*
| 对象 | 访谈主题 | 典型维度 |
|------|----------|----------|
| 校长 | 学校发展与管理 | 发展战略、办学理念、管理创新、特色建设 |
| 教师 | 教学实践与成长 | 教学实践、课程改革、学生培养、专业成长 |
| 学生 | 学习体验与需求 | 学习感受、成长困惑、校园生活、发展需求 |

*页面布局（两栏式）：*
```
┌─────────────────────────────────────────────────────────────────────────────┐
│ ← 返回   校长访谈提纲                                    [预览] [保存]       │
├─────────────────────────────────────────────────────────────────────────────┤
│ 访谈主题: [学校发展战略与办学理念访谈_______]     预计时长: [45] 分钟       │
│ 访谈对象: [校长 ▼]    访谈说明: [了解学校发展思路和管理创新情况...]        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│ ┌─ 访谈维度 ──────────────────────────────────────────────────── + 添加 ──┐ │
│ │                                                                          │ │
│ │ ▼ 一、发展战略                                               ∧∨ ✏️ 🗑️  │ │
│ │   │                                                                      │ │
│ │   ├─ 1. 请介绍学校的发展定位和中长期规划？                   ∧∨ ✏️ 🗑️  │ │
│ │   │      关键要点: 办学目标、发展愿景、阶段规划                         │ │
│ │   │      追问提示: 规划制定过程、师生参与度、实施进展                   │ │
│ │   │      [必问] [开放题]                                                │ │
│ │   │                                                                      │ │
│ │   └─ 2. 学校在落实"双减"政策方面有哪些具体举措？             ∧∨ ✏️ 🗑️  │ │
│ │          关键要点: 作业管理、课后服务、课堂提质                         │ │
│ │          追问提示: 实施效果、家长反馈、困难挑战                         │ │
│ │          [必问] [开放题]                                                │ │
│ │                                                                          │ │
│ │ ▼ 二、办学理念                                               ∧∨ ✏️ 🗑️  │ │
│ │   │                                                                      │ │
│ │   ├─ 3. 学校的核心办学理念是什么？如何体现在日常管理中？     ∧∨ ✏️ 🗑️  │ │
│ │   │      关键要点: 育人理念、价值追求、文化特色                         │ │
│ │   │      [必问] [开放题]                                                │ │
│ │   │                                                                      │ │
│ │   └─ 4. 在教师队伍建设方面，学校有哪些特色做法？             ∧∨ ✏️ 🗑️  │ │
│ │          关键要点: 培养机制、激励措施、团队建设                         │ │
│ │          [选问] [开放题]                                                │ │
│ │                                                                          │ │
│ │ ▶ 三、管理创新                                               ∧∨ ✏️ 🗑️  │ │
│ │                                                                          │ │
│ │ ▶ 四、特色建设                                               ∧∨ ✏️ 🗑️  │ │
│ │                                                                          │ │
│ └──────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│ [+ 添加维度]    [+ 添加问题]                                                │
└─────────────────────────────────────────────────────────────────────────────┘
```

*访谈提纲结构：*
| 层级 | 名称 | 说明 |
|------|------|------|
| 维度 | 访谈维度 | 如"发展战略"、"办学理念"，用于组织问题 |
| 问题 | 访谈问题 | 具体的访谈问题，包含要点和追问提示 |

*维度属性：*
| 属性 | 类型 | 必填 | 说明 |
|------|------|:----:|------|
| 维度名称 | string | ✓ | 如"发展战略"、"教学实践" |
| 维度说明 | string | | 该维度的访谈目的说明 |
| 排序 | number | | 维度显示顺序 |

*问题属性：*
| 属性 | 类型 | 必填 | 说明 |
|------|------|:----:|------|
| 问题内容 | string | ✓ | 访谈问题的具体表述 |
| 关键要点 | string | | 回答中应关注的核心要点，逗号分隔 |
| 追问提示 | string | | 可选的追问方向，帮助深入了解 |
| 是否必问 | enum | ✓ | 必问 / 选问 |
| 问题类型 | enum | ✓ | 开放题 / 封闭题 |
| 排序 | number | | 问题显示顺序 |

*问题编辑弹窗：*
```
┌─ 编辑访谈问题 ─────────────────────────────────────────────────┐
│                                                                 │
│ * 问题内容                                                      │
│ ┌─────────────────────────────────────────────────────────────┐│
│ │ 请介绍学校的发展定位和中长期规划？                           ││
│ └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│   关键要点（访谈时重点关注）                                    │
│ ┌─────────────────────────────────────────────────────────────┐│
│ │ 办学目标、发展愿景、阶段规划、资源配置                       ││
│ └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│   追问提示（可选，帮助深入了解）                                │
│ ┌─────────────────────────────────────────────────────────────┐│
│ │ 规划制定过程中师生参与度如何？目前实施进展怎样？             ││
│ └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│   问题设置                                                      │
│   是否必问: ○ 必问  ○ 选问                                     │
│   问题类型: ○ 开放题  ○ 封闭题                                 │
│                                                                 │
│                                    [取消]    [保存]             │
└─────────────────────────────────────────────────────────────────┘
```

*主流程：*
1. 从列表点击"编辑工具"进入访谈提纲设计器
2. 填写访谈基本信息（主题、对象、时长、说明）
3. 点击"+ 添加维度"创建访谈维度
4. 在维度下点击"+ 添加问题"添加访谈问题
5. 编辑问题内容、关键要点、追问提示
6. 设置问题属性（必问/选问、开放/封闭）
7. 使用"∧∨"按钮调整维度和问题顺序
8. 点击"预览"查看访谈提纲效果
9. 点击"保存"保存提纲

*操作按钮：*
| 按钮 | 功能 |
|------|------|
| 返回 | 返回工具列表 |
| 预览 | 预览访谈提纲（打印友好格式） |
| 保存 | 保存当前提纲 |
| + 添加维度 | 添加新的访谈维度 |
| + 添加问题 | 在当前维度下添加问题 |

*维度/问题操作：*
| 操作 | 说明 |
|------|------|
| ∧∨ | 上移/下移调整顺序 |
| ✏️ | 编辑维度/问题 |
| 🗑️ | 删除（维度删除时问题一并删除） |

*异常流程：*
| 异常 | 处理方式 |
|------|----------|
| 维度名称为空 | 提示"请输入维度名称" |
| 问题内容为空 | 提示"请输入问题内容" |
| 无问题的维度 | 发布时警告"维度[xxx]下无访谈问题" |

---

**UC-TOOL-04: 编辑现场查验工具（检查清单设计器）**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-04 |
| 用例名称 | 编辑现场查验工具 |
| 用例简述 | 使用检查清单设计器编辑现场查验类型工具，按检查类别组织检查项，配置达标标准和判定选项，支持拍照取证 |
| 参与者 | 系统管理员 |
| 前置条件 | 工具类型为"现场查验"，状态为"草稿"或"编辑中" |
| 后置条件 | 检查清单保存成功 |

*现场查验类别：*
| 类别 | 查验内容 | 典型检查项 |
|------|----------|------------|
| 安全设施 | 消防、监控、应急等 | 消防设施配置、监控系统运行、应急通道畅通、安全标识规范 |
| 实验室 | 管理、设备、安全等 | 管理制度上墙、设备维护记录、药品分类存放、防护用品配备 |
| 图书馆 | 运营、服务、环境等 | 开放时间公示、藏书数量达标、借阅制度完善、阅读环境良好 |
| 教学设施 | 教室、操场、功能室等 | 多媒体设备完好、操场设施安全、功能室配置齐全 |

*页面布局（两栏式）：*
```
┌─────────────────────────────────────────────────────────────────────────────┐
│ ← 返回   学校安全设施检查清单                                [预览] [保存]  │
├─────────────────────────────────────────────────────────────────────────────┤
│ 清单名称: [学校安全设施现场查验________________]                            │
│ 查验对象: [学校 ▼]    清单说明: [检查学校消防、监控、应急通道等设施...]    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│ ┌─ 检查类别 ──────────────────────────────────────────────────── + 添加 ──┐ │
│ │                                                                          │ │
│ │ ▼ 一、消防设施                                               ∧∨ ✏️ 🗑️  │ │
│ │   │                                                                      │ │
│ │   ├─ 1. 灭火器配置                                           ∧∨ ✏️ 🗑️  │ │
│ │   │      达标标准: 每层楼配备≥2个灭火器，有效期内，位置明显              │ │
│ │   │      判定选项: ○达标 ○不达标 ○部分达标                             │ │
│ │   │      [必查] [需拍照]                                                │ │
│ │   │                                                                      │ │
│ │   ├─ 2. 消防栓完好                                           ∧∨ ✏️ 🗑️  │ │
│ │   │      达标标准: 消防栓箱完整，水带、水枪齐全，定期检查有记录          │ │
│ │   │      判定选项: ○达标 ○不达标 ○部分达标                             │ │
│ │   │      [必查] [需拍照]                                                │ │
│ │   │                                                                      │ │
│ │   └─ 3. 消防通道畅通                                         ∧∨ ✏️ 🗑️  │ │
│ │          达标标准: 消防通道无杂物堆放，宽度≥1.4米，标识清晰              │ │
│ │          判定选项: ○达标 ○不达标 ○部分达标 ○不适用                     │ │
│ │          [必查] [需拍照]                                                │ │
│ │                                                                          │ │
│ │ ▼ 二、监控系统                                               ∧∨ ✏️ 🗑️  │ │
│ │   │                                                                      │ │
│ │   ├─ 4. 监控覆盖范围                                         ∧∨ ✏️ 🗑️  │ │
│ │   │      达标标准: 校门、操场、走廊、楼梯等重点区域全覆盖                │ │
│ │   │      [必查] [需拍照]                                                │ │
│ │   │                                                                      │ │
│ │   └─ 5. 监控存储时长                                         ∧∨ ✏️ 🗑️  │ │
│ │          达标标准: 录像保存≥30天，可正常回放                            │ │
│ │          [必查]                                                         │ │
│ │                                                                          │ │
│ │ ▶ 三、应急通道                                               ∧∨ ✏️ 🗑️  │ │
│ │                                                                          │ │
│ │ ▶ 四、安全标识                                               ∧∨ ✏️ 🗑️  │ │
│ │                                                                          │ │
│ └──────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│ [+ 添加类别]    [+ 添加检查项]                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

*检查清单结构：*
| 层级 | 名称 | 说明 |
|------|------|------|
| 类别 | 检查类别 | 如"消防设施"、"监控系统"，用于组织检查项 |
| 检查项 | 具体检查项 | 具体的检查内容，包含达标标准和判定选项 |

*类别属性：*
| 属性 | 类型 | 必填 | 说明 |
|------|------|:----:|------|
| 类别名称 | string | ✓ | 如"消防设施"、"实验室安全" |
| 类别说明 | string | | 该类别的检查目的说明 |
| 排序 | number | | 类别显示顺序 |

*检查项属性：*
| 属性 | 类型 | 必填 | 说明 |
|------|------|:----:|------|
| 检查项名称 | string | ✓ | 检查项的简短名称 |
| 达标标准 | string | ✓ | 详细描述达标的具体要求 |
| 判定选项 | enum[] | ✓ | 可选的判定结果，默认：达标/不达标/部分达标 |
| 支持不适用 | boolean | | 是否包含"不适用"选项 |
| 是否必查 | enum | ✓ | 必查 / 选查 |
| 需要拍照 | boolean | | 是否要求拍照取证 |
| 最少照片数 | number | | 需拍照时，最少上传照片数 |
| 排序 | number | | 检查项显示顺序 |

*判定选项配置：*
| 选项 | 说明 | 默认包含 |
|------|------|:--------:|
| 达标 | 完全符合达标标准 | ✓ |
| 不达标 | 不符合达标标准 | ✓ |
| 部分达标 | 部分符合达标标准 | ✓ |
| 不适用 | 该检查项不适用于当前学校 | 可选 |

*检查项编辑弹窗：*
```
┌─ 编辑检查项 ───────────────────────────────────────────────────┐
│                                                                 │
│ * 检查项名称                                                    │
│ ┌─────────────────────────────────────────────────────────────┐│
│ │ 灭火器配置                                                   ││
│ └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│ * 达标标准（现场查验时的判定依据）                              │
│ ┌─────────────────────────────────────────────────────────────┐│
│ │ 每层楼配备≥2个灭火器，在有效期内，放置位置明显易取          ││
│ └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│   判定选项                                                      │
│   [✓] 达标  [✓] 不达标  [✓] 部分达标  [ ] 不适用               │
│                                                                 │
│   检查设置                                                      │
│   是否必查: ○ 必查  ○ 选查                                     │
│   需要拍照: [✓]    最少照片数: [1]                             │
│                                                                 │
│                                    [取消]    [保存]             │
└─────────────────────────────────────────────────────────────────┘
```

*现场查验填报界面预览：*
```
┌─ 学校安全设施检查 ──────────────────────────────────────────────┐
│ 查验学校: 第一小学    查验时间: 2025-01-15 09:30               │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ 一、消防设施                                                     │
│                                                                  │
│ 1. 灭火器配置 *                                                 │
│    达标标准: 每层楼配备≥2个灭火器，有效期内，位置明显           │
│    ┌─────────────────────────────────────────────────────────┐  │
│    │  ○ 达标    ○ 不达标    ○ 部分达标                       │  │
│    └─────────────────────────────────────────────────────────┘  │
│    问题说明（不达标/部分达标时填写）                            │
│    ┌─────────────────────────────────────────────────────────┐  │
│    │ ________________________________________________        │  │
│    └─────────────────────────────────────────────────────────┘  │
│    拍照取证 *  [📷 拍照] [📁 相册]                              │
│    ┌──────┐ ┌──────┐                                           │
│    │ 📷   │ │  +   │                                           │
│    └──────┘ └──────┘                                           │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

*主流程：*
1. 从列表点击"编辑工具"进入检查清单设计器
2. 填写清单基本信息（名称、对象、说明）
3. 点击"+ 添加类别"创建检查类别
4. 在类别下点击"+ 添加检查项"添加检查项
5. 编辑检查项名称、达标标准
6. 配置判定选项（达标/不达标/部分达标/不适用）
7. 设置是否必查、是否需要拍照
8. 拖拽调整类别和检查项顺序
9. 点击"预览"查看填报效果
10. 点击"保存"保存清单

*操作按钮：*
| 按钮 | 功能 |
|------|------|
| 返回 | 返回工具列表 |
| 预览 | 预览现场查验填报界面 |
| 保存 | 保存当前清单 |
| + 添加类别 | 添加新的检查类别 |
| + 添加检查项 | 在当前类别下添加检查项 |

*类别/检查项操作：*
| 操作 | 说明 |
|------|------|
| ∧∨ | 上移/下移调整顺序 |
| ✏️ | 编辑类别/检查项 |
| 🗑️ | 删除（类别删除时检查项一并删除） |

*异常流程：*
| 异常 | 处理方式 |
|------|----------|
| 类别名称为空 | 提示"请输入类别名称" |
| 检查项名称为空 | 提示"请输入检查项名称" |
| 达标标准为空 | 提示"请输入达标标准" |
| 无检查项的类别 | 发布时警告"类别[xxx]下无检查项" |

---

**UC-TOOL-05: 发布采集工具**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-05 |
| 用例名称 | 发布采集工具 |
| 用例简述 | 将采集工具从草稿/编辑中状态发布为可用状态，发布后可被项目配置使用 |
| 参与者 | 系统管理员 |
| 前置条件 | 工具状态为"草稿"或"编辑中" |
| 后置条件 | 工具状态变为"已发布" |

*主流程：*
1. 在工具列表点击"发布"按钮
2. 系统执行发布校验（表单类型需有字段）
3. 发布成功，状态更新为"已发布"
4. 刷新列表显示新状态

*异常流程：*
| 异常 | 处理方式 |
|------|----------|
| 表单无字段 | 提示"请先添加表单字段" |

---

**UC-TOOL-06: 取消发布采集工具**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-06 |
| 用例名称 | 取消发布采集工具 |
| 用例简述 | 将已发布的采集工具恢复为编辑中状态，若被项目使用则显示警告提示 |
| 参与者 | 系统管理员 |
| 前置条件 | 工具状态为"已发布" |
| 后置条件 | 工具状态变为"编辑中" |

> **引用机制说明**：项目级采集工具通过引用方式使用采集工具库。取消发布后，已关联的项目仍可继续使用该工具，但新项目无法选用。

*主流程：*
1. 在工具列表点击"取消发布"按钮
2. 系统检查该工具是否被项目使用
3. 弹出确认对话框（若被使用则显示警告信息）
4. 点击"确认取消发布"
5. 状态更新为"编辑中"

*确认对话框（未被使用）：*
```
┌─ 确认取消发布 ────────────────────────────────┐
│                                               │
│  确定要取消发布"学校基本信息采集表"吗？        │
│                                               │
│  取消发布后，该工具将无法被新项目选用。        │
│                                               │
│                      [取消]    [确认取消发布]  │
└───────────────────────────────────────────────┘
```

*确认对话框（被项目使用时）：*
```
┌─ 确认取消发布 ────────────────────────────────┐
│                                               │
│  ⚠️ 该工具正被以下项目使用：                   │
│  • 2024年义务教育督导评估                     │
│  • 2024年学前教育专项督导                     │
│                                               │
│  确定要取消发布"学校基本信息采集表"吗？        │
│                                               │
│  取消发布后：                                  │
│  • 已关联的项目仍可继续使用该工具              │
│  • 新项目将无法选用该工具                      │
│                                               │
│                      [取消]    [确认取消发布]  │
└───────────────────────────────────────────────┘
```

---

**UC-TOOL-07: 删除采集工具**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-07 |
| 用例名称 | 删除采集工具 |
| 用例简述 | 删除采集工具及其关联数据，需检查是否被项目或要素使用 |
| 参与者 | 系统管理员 |
| 前置条件 | 工具状态为"草稿"或"编辑中"，且未被项目或要素引用 |
| 后置条件 | 工具及关联数据从系统中移除 |

*主流程：*
1. 在工具列表点击"删除"按钮
2. 系统检查该工具是否被项目或要素引用
3. 若未被引用，弹出确认对话框
4. 点击"确认删除"
5. 系统执行级联删除（表单结构、字段配置等）
6. 刷新列表

*引用检查：*
| 检查项 | 说明 |
|--------|------|
| 项目引用 | 检查是否有项目配置引用该工具 |
| 要素引用 | 检查是否有要素通过 tool_id 关联该工具的字段 |

*异常流程：*
| 异常 | 处理方式 |
|------|----------|
| 已发布状态 | 删除按钮隐藏或禁用 |
| 被项目使用 | 提示"该工具正被以下项目使用，无法删除：{项目名称列表}" |
| 被要素引用 | 提示"该工具的字段被以下要素引用，无法删除：{要素名称列表}" |

*确认对话框：*
```
┌─ 确认删除 ────────────────────────────────────┐
│                                               │
│  ⚠️ 确定要删除"学校基本信息采集表"吗？         │
│                                               │
│  删除后将无法恢复，包括：                      │
│  • 表单结构和所有字段配置                      │
│  • 已保存的表单JSON                           │
│                                               │
│                        [取消]    [确认删除]    │
└───────────────────────────────────────────────┘
```

---

**UC-TOOL-08: 查看采集工具详情**

| 项目 | 内容 |
|------|------|
| 用例编号 | UC-TOOL-08 |
| 用例名称 | 查看采集工具详情 |
| 用例简述 | 点击"工具信息"按钮，弹窗查看工具的名称、类型、填报对象、描述、状态及创建/更新信息 |
| 参与者 | 系统管理员 |
| 前置条件 | 工具存在 |
| 后置条件 | 无状态变更 |

*弹窗布局：*
```
┌─────────────────────────────────────────────────────────────────┐
│ 学校基本信息采集表                                    ● 草稿  ✕ │
├─────────────────────────────────────────────────────────────────┤
│ 创建时间: 2024-06-01 | 创建人: admin | 更新时间: 2025-12-20 |  │
│ 更新人: admin                                                   │
│                                                                 │
│ [表单]  [填报对象: 学校]                                        │
│                                                                 │
│ 采集学校基本信息，包括学校名称、地址、办学类型等基础数据。      │
│                                                                 │
│                                        [关闭]    [✏️ 编辑]     │
└─────────────────────────────────────────────────────────────────┘
```

*主流程：*
1. 在工具列表点击"工具信息"按钮
2. 弹出详情弹窗
3. 查看工具信息
4. 点击"关闭"关闭弹窗，或点击"编辑"修改基础信息
